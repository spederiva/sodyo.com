function site_search(module){const searchResultsWrapper=module.querySelector(".site-search__popup"),searchInput=module.querySelector(".site-search__input"),searchResults=(module.querySelector(".site-search__form"),module.querySelector(".site-search__error"),module.querySelector(".site-search__results-block")),resultTemplate=module.querySelector(".site-search__result-template"),loadMoreResults=module.querySelector(".site-search__more"),searchOpen=module.querySelector(".site-search__open"),searchClose=module.querySelector(".site-search__close");let portalId,language,no_results,term="",offset=0;function search(term,offset){offset||(offset=0);let request=new XMLHttpRequest;request.open("GET","https://api.hubapi.com/contentsearch/v2/search?portalId="+portalId+"&language="+language+"&limit=10&offset="+offset+"&term="+term),request.onreadystatechange=function(){4===this.readyState&&200===this.status&&function(d){let data=JSON.parse(d);data.results,0!=data.total?(data.total>data.limit+data.offset?loadMoreResults.classList.add("site-search__more--active"):loadMoreResults.classList.remove("site-search__more--active"),data.results.forEach((function(item){let template=resultTemplate.cloneNode(!0);template.querySelector(".site-search__result-title").innerHTML='<a href="'+item.url+'">'+item.title+"</a>",template.querySelector(".site-search__result-desc").innerHTML=item.description,searchResults.appendChild(template)})),searchResults.appendChild(loadMoreResults)):searchResults.innerHTML='<div class="site-search__results-zero">'+no_results+"</div>"}(this.responseText)},request.send()}function closeSearchPopup(){document.body.classList.remove("site-search-active"),searchResultsWrapper.classList.remove("site-search__popup--active"),module.querySelector(".site-search__input").value="",searchResults.innerHTML="",searchInput.blur(),searchResultsWrapper.classList.remove("site-search__popup--form-submitted")}resultTemplate.remove(),resultTemplate.className="site-search__result",module.querySelector(".site-search__form").addEventListener("submit",(function(e){e.preventDefault(),searchResults.innerHTML="",offset=0,term=e.target.elements.searchInput.value,language=e.target.elements.language.value,portalId=e.target.elements.portalId.value,no_results=e.target.getAttribute("results-zero-text"),search(term),searchResultsWrapper.classList.add("site-search__popup--form-submitted"),searchInput.blur()})),loadMoreResults.addEventListener("click",(function(e){offset+=10,search(term,offset)})),searchOpen.addEventListener("click",(function(){document.body.classList.add("site-search-active"),searchResultsWrapper.classList.add("site-search__popup--active"),searchResultsWrapper.addEventListener("animationend",(function(){searchResultsWrapper.classList.contains("site-search__popup--form-submitted")||searchInput.focus()}))})),searchClose.addEventListener("click",closeSearchPopup),document.addEventListener("click",(function(event){event.target.closest(".site-search__results-block")||event.target.closest(".site-search__open")||event.target.closest(".site-search__form")||closeSearchPopup()}))}var site_search_modules=document.querySelectorAll(".site-search");for(i=0;i<site_search_modules.length;i++)site_search(site_search_modules[i]);
//# sourceURL=https://cdn2.hubspot.net/hub/3890348/hub_generated/template_assets/52445475586/1652326455421/Act3_Sodyo/js/components/site-search.js